<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Reparto de Propinas</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: #f0f0f0;
    }

    .rectangulo {
      max-width: 800px;
      margin: 40px auto;
      background-color: #1e1e1e;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 0 15px rgba(0,0,0,0.5);
      overflow-y: auto;
    }

    h1, h2 {
      color: #ffffff;
      text-align: center;
    }

    label {
      display: block;
      margin-top: 15px;
    }

    input, select, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: none;
      border-radius: 8px;
    }

    button {
      background-color: #03a9f4;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      background-color: #0288d1;
    }

    .empleado {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .resultado {
      margin-top: 25px;
      background-color: #2c2c2c;
      padding: 15px;
      border-radius: 10px;
    }

    .faltante {
      background-color: #3b3b3b;
      padding: 10px;
      border-radius: 8px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="rectangulo">
    <h1>Reparto de Propinas</h1>

    <label>1. Total de propina:</label>
    <input type="number" id="totalPropina" step="0.01">

    <label>2. Cantidad de empleados:</label>
    <input type="number" id="cantidadEmpleados">

    <label>3. ¿Por cuántos días se repartirá la propina? (15 o 30):</label>
    <input type="number" id="diasReparto">

    <label>4. ¿Hay empleados con incapacidad o vacaciones?</label>
    <select id="hayFaltas" onchange="mostrarFaltas(this.value)">
      <option value="no">No</option>
      <option value="sí">Sí</option>
    </select>

    <div id="faltasContainer" style="display:none;">
      <label>5. Agrega empleados con días no trabajados:</label>
      <div id="listaFaltas"></div>
      <button onclick="agregarEmpleado()">Agregar empleado</button>
    </div>

    <button onclick="calcularReparto()">Calcular reparto</button>

    <div class="resultado" id="resultado"></div>
  </div>

  <script>
    function mostrarFaltas(valor) {
      document.getElementById('faltasContainer').style.display = valor === 'sí' ? 'block' : 'none';
      if (valor === 'no') {
        document.getElementById('listaFaltas').innerHTML = '';
      }
    }

    function agregarEmpleado() {
      const div = document.createElement('div');
      div.className = 'empleado';
      div.innerHTML = `
        <input type="text" placeholder="Nombre" class="nombre">
        <input type="number" placeholder="Días no trabajados" class="dias" min="1">
        <button onclick="eliminarEmpleado(this)">Eliminar</button>
      `;
      document.getElementById('listaFaltas').appendChild(div);
    }

    function eliminarEmpleado(btn) {
      btn.parentElement.remove();
    }

    function calcularReparto() {
      const totalPropina = parseFloat(document.getElementById('totalPropina').value);
      const cantidadEmpleados = parseInt(document.getElementById('cantidadEmpleados').value);
      const diasReparto = parseInt(document.getElementById('diasReparto').value);
      const hayFaltas = document.getElementById('hayFaltas').value;

      if (isNaN(totalPropina) || isNaN(cantidadEmpleados) || isNaN(diasReparto)) {
        alert('Todos los campos deben estar completos.');
        return;
      }

      let empleadosConFalta = 0;
      let totalDescuento = 0;
      let detallesFaltantes = '';

      const valorDiario = totalPropina / (cantidadEmpleados * diasReparto);

      if (hayFaltas === 'sí') {
        const nombres = document.querySelectorAll('.nombre');
        const dias = document.querySelectorAll('.dias');

        for (let i = 0; i < nombres.length; i++) {
          const nombre = nombres[i].value.trim();
          const diasNoTrabajados = parseInt(dias[i].value);

          if (nombre === '' || isNaN(diasNoTrabajados)) {
            alert('Completa todos los campos de empleados con faltas.');
            return;
          }

          empleadosConFalta++;
          const descuento = valorDiario * diasNoTrabajados;
          totalDescuento += descuento;

          const totalEmpleado = valorDiario * (diasReparto - diasNoTrabajados);
          detallesFaltantes += `
            <div class="faltante">
              <strong>${nombre}</strong>: $${totalEmpleado.toFixed(2)} (-$${descuento.toFixed(2)})
            </div>
          `;
        }
      }

      const empleadosSinFalta = cantidadEmpleados - empleadosConFalta;
      const totalSinFalta = totalPropina - totalDescuento;
      const repartoSinFaltaPorEmpleado = empleadosSinFalta > 0 ? totalSinFalta / empleadosSinFalta : 0;

      document.getElementById('resultado').innerHTML = `
        <p><strong>Valor por día trabajado:</strong> $${valorDiario.toFixed(2)}</p>
        <p><strong>Total general por empleado (x${diasReparto} días):</strong> $${(valorDiario * diasReparto).toFixed(2)}</p>

        <p><strong>6. Total a repartir empleados con falta:</strong> $${(valorDiario * diasReparto * empleadosConFalta).toFixed(2)} (-$${totalDescuento.toFixed(2)})</p>
        ${detallesFaltantes}

        <p><strong>7. Total a repartir empleados sin falta:</strong> $${totalSinFalta.toFixed(2)} (${empleadosSinFalta} empleados)</p>
        <p><strong>Reparto individual:</strong> $${repartoSinFaltaPorEmpleado.toFixed(2)} por empleado sin falta</p>
      `;
    }
  </script>
</body>
</html>
